import{r as t,h as i,a as e}from"./p-3b8a929f.js";import{i as s}from"./p-dc634267.js";import{r as l}from"./p-8657a933.js";const a=class{constructor(e){t(this,e),this.headertitle=s("interactiveMedia.title"),this.headertext=s("interactiveMedia.description"),this.headericon="signpost",this.renderButton=t=>{var e,s;return i("button",Object.assign({class:"c-button c-button--primary u-text--small"},t.attr),(null===(e=t.icon)||void 0===e?void 0:e.left)&&i("i",{class:"material-icons"},t.icon.left),t.value,(null===(s=t.icon)||void 0===s?void 0:s.right)&&i("i",{class:"material-icons"},t.icon.right))}}init(){this.current=this.medias[0]}reset(){this.quizSelectedAnswer=null}handleQuizSelect({detail:t}){this.quizSelectedAnswer=t}setCurrent(t){this.current=this.medias.find((i=>i.id==t))}handleQuizSubmit(){var t;this.current.answer=null===(t=this.current)||void 0===t?void 0:t.answers.find((t=>t.id===this.quizSelectedAnswer.id)),this.setCurrent(this.quizSelectedAnswer.value)}componentWillLoad(){fetch(this.config).then((t=>t.json())).then((t=>{this.medias=t}))}getVideo(t){return i("div",{class:"c-interactive-video"},i("yduqs-video-player",{transparent:!0,src:t.url,videoId:String(t.id),covered:t.covered,width:"100%"}),i("footer",null,this.renderButton({value:s("interactiveMedia.video.btn"),icon:{right:"chevron_right"},attr:{onClick:()=>this.setCurrent(t.goto)}})))}getQuiz(t){var e,a;const c=null===(e=t.answers)||void 0===e?void 0:e.map((t=>({id:t.id,label:t.text,value:t.to}))),r=null===(a=this.medias)||void 0===a?void 0:a.filter((t=>"quiz"===t.type));return i("div",{class:"c-interactive-quiz"},i("yduqs-quiz",{dataid:t.id,overline:l(s("interactiveMedia.quiz.overline"),{index:String(((null==r?void 0:r.filter((t=>Boolean(t.answer))).length)||0)+1),total:String(null==r?void 0:r.length)}),question:t.text,answers:c}),i("footer",null,this.renderButton({value:s("interactiveMedia.quiz.btn"),attr:{disabled:!Boolean(this.quizSelectedAnswer),onClick:()=>this.handleQuizSubmit()}})))}getInfo(t){var e;return i("div",{class:"c-interactive-info"},i("h2",{class:"c-info-title"},t.title),i("p",{class:"c-info-text"},t.text),i("footer",null,null===(e=t.goto)||void 0===e?void 0:e.map((t=>this.renderButton({value:t.text,attr:{onClick:()=>this.setCurrent(t.to)}})))))}getScore(t){var e;const l=this.medias.filter((t=>"quiz"===t.type));let a=0,c=0;const r=l.map((t=>{let i=0;return t.answers.forEach((t=>{i=i<t.points?t.points:i})),a+=i,c+=t.answer.points,{score:t.answer.points,total:i,label:t.module.name,anchor:{url:t.module.anchor,label:s("interactiveMedia.score.anchorLabel")}}})),o=s("interactiveMedia.score.subtitle."+(0===c?"none":c<a?"some":"all"));return i("div",{class:"c-interactive-score"},i("yduqs-score",{datatitle:t.title||s("interactiveMedia.score.title"),datasubtitle:t.subtitle||o,dataid:t.id,items:r}),i("footer",null,null===(e=t.goto)||void 0===e?void 0:e.map((t=>this.renderButton({value:t.text,attr:{onClick:()=>this.setCurrent(t.to)}})))))}getComponent(t){switch(t.type){case"video":return this.getVideo(t);case"quiz":return this.getQuiz(t);case"info":return this.getInfo(t);case"score":return this.getScore(t);default:return this.getInfo(t)}}render(){return i(e,{class:"c-interactive"},i("slot",{name:"header"},i("header",{class:"c-interactive-header"},i("div",{class:"row align-items-center justify-content-start"},i("div",{class:"col-12 col-md-1 col-lg-1 offset-lg-1"},i("i",{class:"icon material-icons"},this.headericon)),i("div",{class:"col-12 col-md-10 col-lg-8"},i("h3",{class:"c-heading c-interactive-header-title"},this.headertitle))),i("div",{class:"row align-items-center justify-content-start"},i("div",{class:"col-12 col-md-1 col-lg-1 offset-lg-1"}),i("div",{class:"col-12 col-md-10 col-lg-8"},i("p",{class:"c-interactive-header-text"},this.headertext))))),i("div",{class:"c-interactive-container"},i("div",{class:"row align-items-center justify-content-start"},i("div",{class:"col-12 col-md-1 col-lg-1 offset-lg-1"}),i("div",{class:"col-12 col-md-10 col-lg-8"},this.current?this.getComponent(this.current):i("div",null,"LOading")))))}static get watchers(){return{medias:["init"],current:["reset"]}}};export{a as yduqs_interactive_media}