import{r as t,h as s,a as i}from"./p-48a93f8f.js";const h=class{constructor(s){t(this,s),this.max=20,this.min=0,this.step=1,this.val=0,this.evCache=new Array,this.prevDiff=-1,this.mouseScrollEventName="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll",this.lastX=0,this.lastY=0,this.refX=0,this.refY=0}handleClick(t){const{className:s}=t.target,i=s.split(" ");(i.includes("p-img")||i.includes("p-btn"))&&(this.fullScreen=!this.fullScreen)}reset(){this.fullScreen&&(this.initialWidth=this.img.clientWidth),this.rangeOutput(0),this.setImgMargins({left:0,top:0})}setImgWidth(t){this.img.style.width=`calc(${this.initialWidth}px + ${10*t}%)`}isNegative(t){return t<0}setImgMargins(t){const s=this.img.clientHeight,i=this.img.clientWidth,h=this.container.clientHeight,e=this.container.clientWidth,n=i<=e?0:(i-e)/2,o=s<=h?0:(s-h)/2;let a,r;a=this.isNegative(t.left)?t.left<-n?-n:t.left:t.left>n?n:t.left,r=this.isNegative(t.top)?t.top<-o?-o:t.top:t.top>o?o:t.top,this.lastX=a,this.lastY=r,this.img.style.marginLeft=`${a}px`,this.img.style.marginTop=`${r}px`}rangeOutput(t){this.val=t>this.max?this.max:t<this.min?this.min:t,this.setImgWidth(this.val),this.setImgMargins({left:this.lastX,top:this.lastY})}handlePointerDown(t){this.evCache.push(t)}handlePointerMove(t){for(var s=0;s<this.evCache.length;s++)if(t.pointerId==this.evCache[s].pointerId){this.evCache[s]=t;break}if(2==this.evCache.length){var i=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>0&&(i>this.prevDiff&&this.rangeOutput(this.val+this.step),i<this.prevDiff&&this.rangeOutput(this.val-this.step)),this.prevDiff=i}}handlePointerUp(t){this.removeEvent(t),this.evCache.length<2&&(this.prevDiff=-1)}removeEvent(t){for(var s=0;s<this.evCache.length;s++)if(this.evCache[s].pointerId==t.pointerId){this.evCache.splice(s,1);break}}handleTouchStart(t){var s;2===(null===(s=t.targetTouches)||void 0===s?void 0:s.length)&&t.preventDefault()}scrollDirectionIsUpDown(t){return 0!==(t.deltaY||t.wheelDeltaY)}normalizeScrollData(t){var s;if(t.wheelDelta)s=t.wheelDelta%120-0==-0?t.wheelDelta/120:t.wheelDelta/12;else{var i=t.deltaY?t.deltaY:t.detail;s=-(i%3?10*i:i/3)}return s}handleMouseScroll(t){this.fullScreen&&this.scrollDirectionIsUpDown(t)&&(t.preventDefault(),this.normalizeScrollData(t)>0?this.rangeOutput(this.val+this.step):this.rangeOutput(this.val-this.step))}handleDragStart(t){this.dragXStart=t.screenX,this.dragYStart=t.screenY}handleDragOver(t){this.setImgMargins({top:this.lastY+.07*(t.screenY-this.dragYStart),left:this.lastX+.07*(t.screenX-this.dragXStart)})}handleDragEnd(t){this.lastX=this.lastX+(t.screenX-this.dragXStart),this.lastY=this.lastY+(t.screenY-this.dragYStart)}handleTouchDragStart(t){var s;if(1===(null===(s=t.targetTouches)||void 0===s?void 0:s.length)){const s=t.targetTouches[0];this.dragXStart=null==s?void 0:s.screenX,this.dragYStart=null==s?void 0:s.screenY}}handleTouchDragMove(t){var s;if(1===(null===(s=t.targetTouches)||void 0===s?void 0:s.length)){const s=t.targetTouches[0],i=.1*(s.screenX-this.dragXStart),h=.1*(s.screenY-this.dragYStart);this.setImgMargins({left:this.lastX+(i!=this.refX?i:0),top:this.lastY+(h!=this.refY?h:0)}),this.refX=i!=this.refX?i:this.refX,this.refY=h!=this.refY?h:this.refY}}handleTouchDragEnd(t){var s;if(1===(null===(s=t.targetTouches)||void 0===s?void 0:s.length)){const s=t.targetTouches[0];this.lastX=this.lastX+(s.screenX-this.dragXStart),this.lastY=this.lastY+(s.screenY-this.dragYStart)}}componentDidLoad(){this.img.onpointerdown=t=>this.handlePointerDown(t),this.img.onpointermove=t=>this.handlePointerMove(t),this.img.onpointerup=t=>this.handlePointerUp(t),this.img.onpointercancel=t=>this.handlePointerUp(t),this.img.onpointerout=t=>this.handlePointerUp(t),this.img.onpointerleave=t=>this.handlePointerUp(t),this.img.addEventListener("touchstart",(t=>this.handleTouchStart(t)),{passive:!1}),this.img.addEventListener(this.mouseScrollEventName,(t=>this.handleMouseScroll(t)))}render(){return s(i,{class:"c-image-full-screen"},s("div",{class:"p-"+(this.fullScreen?"full-screen":"preview"),ref:t=>this.container=t},s("button",{type:"button",class:"c-button c-button__icon-container c-button__icon-small u-text--small p-btn p-open-in-full"},s("span",{class:"p-btn c-button__icon material-icons"},this.fullScreen?"close":"open_in_full")),s("img",{draggable:!0,onTouchStart:t=>this.handleTouchDragStart(t),onTouchMove:t=>this.handleTouchDragMove(t),onTouchEnd:t=>this.handleTouchDragEnd(t),onDragStart:t=>this.handleDragStart(t),onDragOver:t=>this.handleDragOver(t),onDragEnd:t=>this.handleDragEnd(t),class:"p-img",src:this.src,alt:this.alt,ref:t=>this.img=t}),this.fullScreen&&s("div",{class:"p-range-container"},s("yduqs-range",{max:this.max,min:this.min,step:this.step,value:this.val,output:t=>this.rangeOutput(t)}))))}static get watchers(){return{fullScreen:["reset"]}}};export{h as yduqs_zoom_full_screen}