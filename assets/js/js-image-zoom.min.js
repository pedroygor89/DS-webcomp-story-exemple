function zoomImage(e) { this.render(e) } function buildZoom(e) { var o = window.innerWidth; o <= 800 ? e.querySelectorAll("#img-container-zoom").forEach(e => { var o = e.querySelector("img"); o.removeAttribute("style"); var t = o.dataset.width; o.setAttribute("style", "width:" + t + "px"); var m = e.querySelector(".js-image-zoom__zoomed-image"); m && e.removeChild(m); var n = e.querySelector(".js-image-zoom__zoomed-area"); n && e.removeChild(n), o.classList.add("img-enlargeable"), o.addEventListener("click", function () { var e, o = $(this).attr("src"); function t() { e.remove(), $("body").off("keyup.modal-close") } document.querySelector(".modalZoom") || (e = $('<div class="modalZoom">').css({ background: "RGBA(0,0,0,.5) url(" + o + ") no-repeat center", backgroundSize: "contain", width: "100%", height: "100%", position: "fixed", zIndex: "10000", top: "0", left: "0", cursor: "zoom-out" }).click(function () { t() }).appendTo("body")), $("body").on("keyup.modal-close", function (e) { "Escape" === e.key && t() }) }) }) : o > 800 && (document.querySelectorAll(".modalZoom").forEach(e => { e && e.remove() }), e.querySelectorAll("#img-container-zoom").forEach(e => { var o = e.querySelector("img"); new ImageZoom(e, { width: o.dataset.width, zoomWidth: o.dataset.zoomWidth, offset: { vertical: o.dataset.vertical, horizontal: o.dataset.horizontal }, zoomPosition: o.dataset.zoomPosition, scale: o.dataset.scale }) })) } function ImageZoom(e, o) { "use strict"; var t = o; if (e) { var m, n, s, i = { sourceImg: { element: null, width: 0, height: 0, naturalWidth: 0, naturalHeight: 0 }, zoomedImgOffset: { vertical: 0, horizontal: 0 }, zoomedImg: { element: null, width: 0, height: 0 }, zoomLens: { element: null, width: 0, height: 0 } }, l = document.createElement("div"), a = document.createElement("div"); i.zoomedImgOffset = { vertical: t.offset && t.offset.vertical ? t.offset.vertical : 0, horizontal: t.offset && t.offset.horizontal ? t.offset.horizontal : 0 }, i.zoomPosition = t.zoomPosition || "right", i.zoomContainer = t.zoomContainer ? t.zoomContainer : e; var r = { handleEvent: function (e) { switch (e.type) { case "mousemove": return this.handleMouseMove(e); case "mouseenter": return this.handleMouseEnter(e); case "mouseleave": return this.handleMouseLeave(e); case "scroll": return this.handleScroll(e) } }, handleMouseMove: function (e) { var o, t, l; s && (o = g(e.clientX - s.left), t = u(e.clientY - s.top), l = "-" + o * m + "px -" + t * n + "px", i.zoomedImg.element.style.backgroundPosition = l, i.zoomLens.element.style.cssText += "top:" + t + "px;left:" + o + "px;display: block;") }, handleMouseEnter: function () { i.zoomedImg.element.style.display = "block", i.zoomLens.element.style.display = "block" }, handleMouseLeave: function () { i.zoomedImg.element.style.display = "none", i.zoomLens.element.style.display = "none" }, handleScroll: function () { s = d(i.sourceImg.element) } }; return z(), i.sourceImg.element.complete ? p() : i.sourceImg.element.onload = p, { setup: function () { z() }, kill: function () { h() }, _getInstanceInfo: function () { return { setup: z, kill: h, onSourceImgLoad: p, data: i, options: t } } } } function d(e) { if (e) { var o = e.getBoundingClientRect(); return { left: o.left, top: o.top } } return { left: 0, top: 0 } } function c(e, o, t) { return function (e, o, t) { return e < o ? o : e > t ? t : e }(e, o, t) - o } function g(e) { var o, m = i.zoomLens.width / 2; return c(e, m, (o = m, t.width - o)) } function u(e) { var o, m = i.zoomLens.height / 2; return c(e, m, (o = m, t.height - o)) } function p() { t.height = t.height || i.sourceImg.element.height, i.sourceImg.element.style.height = t.height + "px", t.width = t.width || i.sourceImg.element.width, i.sourceImg.element.style.width = t.width + "px", function (e, o) { e.scale ? (o.zoomedImg.element.style.width = e.width * e.scale + "px", o.zoomedImg.element.style.height = e.height * e.scale + "px") : e.zoomWidth ? (o.zoomedImg.element.style.width = e.zoomWidth + "px", o.zoomedImg.element.style.height = o.sourceImg.element.style.height) : (o.zoomedImg.element.style.width = "100%", o.zoomedImg.element.style.height = "100%") }(t, i), i.sourceImg.naturalWidth = i.sourceImg.element.naturalWidth, i.sourceImg.naturalHeight = i.sourceImg.element.naturalHeight, i.zoomedImg.element.style.backgroundSize = i.sourceImg.naturalWidth + "px " + i.sourceImg.naturalHeight + "px", t.zoomStyle && (i.zoomedImg.element.style.cssText += t.zoomStyle), t.zoomLensStyle ? i.zoomLens.element.style.cssText += t.zoomLensStyle : (i.zoomLens.element.style.background = "white", i.zoomLens.element.style.opacity = "0.4"), m = i.sourceImg.naturalWidth / t.width, n = i.sourceImg.naturalHeight / t.height, s = d(i.sourceImg.element), t.scale ? (i.zoomLens.width = t.width / (i.sourceImg.naturalWidth / (t.width * t.scale)), i.zoomLens.height = t.height / (i.sourceImg.naturalHeight / (t.height * t.scale))) : t.zoomWidth ? (i.zoomLens.width = t.zoomWidth / m, i.zoomLens.height = t.height / n) : (i.zoomedImg.element.style.display = "block", i.zoomLens.width = i.zoomedImg.element.clientWidth / m, i.zoomLens.height = i.zoomedImg.element.clientHeight / n, i.zoomedImg.element.style.display = "none"), i.zoomLens.element.style.position = "absolute", i.zoomLens.element.style.width = i.zoomLens.width + "px", i.zoomLens.element.style.height = i.zoomLens.height + "px", i.zoomLens.element.pointerEvents = "none" } function z() { if (t.img) { var o = document.createElement("img"); o.src = t.img, i.sourceImg.element = e.appendChild(o) } else i.sourceImg.element = e.children[0], "IMG" !== i.sourceImg.element.nodeName && (i.sourceImg.element = i.sourceImg.element.querySelector("img")); switch (t = t || {}, e.style.position = "relative", i.sourceImg.element.style.width = t.width ? t.width + "px" : "auto", i.sourceImg.element.style.height = t.height ? t.height + "px" : "auto", i.zoomLens.element = e.appendChild(a), i.zoomLens.element.style.display = "none", i.zoomLens.element.classList.add("js-image-zoom__zoomed-area"), i.zoomedImg.element = i.zoomContainer.appendChild(l), i.zoomedImg.element.classList.add("js-image-zoom__zoomed-image"), i.zoomedImg.element.style.backgroundImage = "url('" + i.sourceImg.element.src + "')", i.zoomedImg.element.style.backgroundRepeat = "no-repeat", i.zoomedImg.element.style.display = "none", i.zoomPosition) { case "left": i.zoomedImg.element.style.position = "absolute", i.zoomedImg.element.style.top = i.zoomedImgOffset.vertical + "px", i.zoomedImg.element.style.left = i.zoomedImgOffset.horizontal - 2 * i.zoomedImgOffset.horizontal + "px", i.zoomedImg.element.style.transform = "translateX(-100%)"; break; case "top": i.zoomedImg.element.style.position = "absolute", i.zoomedImg.element.style.top = i.zoomedImgOffset.vertical - 2 * i.zoomedImgOffset.vertical + "px", i.zoomedImg.element.style.left = "calc(50% + " + i.zoomedImgOffset.horizontal + "px)", i.zoomedImg.element.style.transform = "translate3d(-50%, -100%, 0)"; break; case "bottom": i.zoomedImg.element.style.position = "absolute", i.zoomedImg.element.style.bottom = i.zoomedImgOffset.vertical - 2 * i.zoomedImgOffset.vertical + "px", i.zoomedImg.element.style.left = "calc(50% + " + i.zoomedImgOffset.horizontal + "px)", i.zoomedImg.element.style.transform = "translate3d(-50%, 100%, 0)"; break; case "original": i.zoomedImg.element.style.position = "absolute", i.zoomedImg.element.style.top = "0px", i.zoomedImg.element.style.left = "0px"; break; default: i.zoomedImg.element.style.position = "absolute", i.zoomedImg.element.style.top = i.zoomedImgOffset.vertical + "px", i.zoomedImg.element.style.right = i.zoomedImgOffset.horizontal - 2 * i.zoomedImgOffset.horizontal + "px", i.zoomedImg.element.style.transform = "translateX(100%)" }return e.addEventListener("mousemove", r, !1), e.addEventListener("mouseenter", r, !1), e.addEventListener("mouseleave", r, !1), i.zoomLens.element.addEventListener("mouseenter", r, !1), i.zoomLens.element.addEventListener("mouseleave", r, !1), window.addEventListener("scroll", r, !1), i } function h() { return e.removeEventListener("mousemove", r, !1), e.removeEventListener("mouseenter", r, !1), e.removeEventListener("mouseleave", r, !1), i.zoomLens.element.removeEventListener("mouseenter", r, !1), i.zoomLens.element.removeEventListener("mouseleave", r, !1), window.removeEventListener("scroll", r, !1), i.zoomLens && i.zoomedImg && (e.removeChild(i.zoomLens.element), i.zoomContainer.removeChild(i.zoomedImg.element)), t.img ? e.removeChild(i.sourceImg.element) : (i.sourceImg.element.style.width = "", i.sourceImg.element.style.height = ""), i } } function zoomSwap() { imgs_zoom.forEach(e => { img_img = e.querySelector("img"), img_src = img_img.getAttribute("src"), img_title = img_img.getAttribute("title"), img_img.classList.remove("d-block"), img_img.classList.add("d-none"), img_caption = e.querySelector("figcaption"), img_text = img_caption.textContent, img_text = img_text.replace(/\s+/g, " ").trim(), img_img.classList.remove("d-block"), img_caption.classList.add("d-none"), swapped_zoom = document.createElement("img"), swap_class = document.createAttribute("class"), swap_class.value = "swapped_zoom_img figure-img img-fluid rounded", swap_src = document.createAttribute("src"), swap_src.value = img_src, swap_title = document.createAttribute("title"), swap_title.value = img_title, swap_data = document.createAttribute("data-enlargeable"), swapped_zoom.setAttributeNode(swap_src), swapped_zoom.setAttributeNode(swap_title), swapped_zoom.setAttributeNode(swap_class), swapped_zoom.setAttributeNode(swap_data), swapped_zoom_caption = document.createElement("figcaption"), swap_zoom_caption_class = document.createAttribute("class"), swap_zoom_caption_class.value = "swapped_zoom_caption figure-caption", swapped_zoom_caption.setAttributeNode(swap_zoom_caption_class), swapped_zoom_caption_icon = document.createElement("i"), swapped_zoom_caption_icon_class = document.createAttribute("class"), swapped_zoom_caption_icon_class.value = "fas fa-camera mr-2", swapped_zoom_caption_icon.setAttributeNode(swapped_zoom_caption_icon_class), swapped_zoom_caption_text = document.createTextNode(img_text), swapped_zoom_caption.appendChild(swapped_zoom_caption_icon), swapped_zoom_caption.appendChild(swapped_zoom_caption_text), e.appendChild(swapped_zoom), e.appendChild(swapped_zoom_caption) }) } function undoZoomSwap() { imgs_zoom.forEach(e => { img_img = e.querySelector("img"), img_img.classList.add("d-block"), img_img.classList.remove("d-none"), img_caption = e.querySelector("figcaption"), img_img.classList.add("d-block"), img_caption.classList.remove("d-none") }), swapped_zoom_img = document.querySelectorAll(".swap_zoom_img"), swapped_zoom_img.forEach(e => { e.classList.remove("d-block"), e.classList.add("d-none") }), swapped_zoom_caption = document.querySelectorAll(".swap_zoom_img"), swapped_zoom_caption.forEach(e => { e.classList.remove("d-block"), e.classList.add("d-none") }) } zoomImage.prototype.render = function (e) { buildZoom(e) }, imgs_zoom = document.querySelectorAll("#img-container-zoom"), imgs_zoom.length > 0 & screen.width <= 480 ? zoomSwap() : imgs_zoom.length > 0 & screen.width > 480 && undoZoomSwap();